/*
 * Copyright 2019-2022 coreLang contributors <https://mal-lang.org/coreLang/contributors.html>
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

category Vulnerability {

  asset HardwareVulnerability extends Vulnerability
    user info: "A vulnerability that affects hardware."
  {
    # confidentialityImpactLimitations @suppress [Disabled]
      user info: "Limits the impact on confidentiality of the vulnerability."
      modeler info: "Analogous defense to the SoftwareVulnerability impact limitations."
      ->  read

    # availabilityImpactLimitations @suppress [Disabled]
      user info: "Limits the impact on availability of the vulnerability."
      modeler info: "Analogous defense to the SoftwareVulnerability impact limitations."
      ->  deny

    # integrityImpactLimitations @suppress [Disabled]
      user info: "Limits the impact on integrity of the vulnerability."
      modeler info: "Analogous defense to the SoftwareVulnerability impact limitations."
      ->  modify

    # effortRequiredToExploit @suppress [Disabled]
      user info: "The vulnerability requires additional effort(time) from the attacker in order to be successful."
      modeler info: "The expectation is that the attacker has prolonged or recurring access to the targeted hardware in order to repeatedly/continuously try the exploit."
      ->  exploitTrivially

    & read
      user info: "The attacker can read some or all of the associated hardware's data."
      ->  hardware.read

    & modify
     user info: "The attacker can modify some or all of the associated hardware's behaviour."
      ->  hardware.modify

    & deny
      user info: "Denial-of-Service attack is an attack in which a machine or hardware component is rendered unavailable to its intended users by temporarily or indefinitely disrupting it."
      ->  hardware.deny

    | attemptExploit @hidden @Override
      developer info: "Intermediate attack step to allow for defenses."
      ->  exploitTrivially,
          exploitWithEffort

    & exploitTrivially @hidden
      developer info: "The exploit is trivial and requires insignificant effort from the attacker in order to be successful."
      -> exploit

    & exploitWithEffort @hidden [Exponential(0.01)]
      developer info: "The attacker must expend effort in order to successfully exploit the vulnerability."
      -> exploit

    | impact @hidden
      developer info: "The actual impact caused by successfully exploiting the vulnerability."
      -> read,
         modify,
         deny
  }
}

associations {
  HardwareVulnerability               [vulnerabilities]   * <-- hardwareVulnerability --> 0..1 [hardware]     Hardware
      user info: "A Hardware system/component can have multiple hardware vulnerabilities."
}
